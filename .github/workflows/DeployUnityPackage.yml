name: Deploy Unity Package

on:
  push:
    branches:
      - master  # Ensure this matches the case of your branch name

jobs:
  update-release:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Get short commit SHA
      run: echo "SHORT_SHA=$(git rev-parse --short HEAD)" >> $GITHUB_ENV

    - name: Define new tag
      run: echo "NEW_TAG=v1.0-${{ env.SHORT_SHA }}" >> $GITHUB_ENV

    - name: Update Release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: ${{ env.NEW_TAG }}
        name: Release ${{ env.NEW_TAG }}
        body: 'Release of commit ${{ env.SHORT_SHA }}'
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
